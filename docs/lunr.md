# wax:lunr

## What it does
`wax:lunr` generates a client-side JSON search index of your site for use with [ElasticLunr.js](http://elasticlunr.com/). It does not take any arguments.

Sample index:

```js
var index = new elasticlunr.Index;
index.setRef('lunr_id');
index.saveDocument(false);
index.addField('title');
index.addField('artist');
index.addField('location');
index.addField('_date');
index.addField('object_type');
index.addField('current_location');
index.addDoc({
  "lunr_id":0,
  "link":"{{ site.baseurl }}/mia-qatar/1/",
  "title":"The Dala'il al-Khayrat of al-Juzuli",
  "artist":"Al-Hajj Hafiz Muhammad Nuri",
  "location":"Turkey",
  "_date":"1801",
  "object_type":"manuscript",
  "current_location":"The Museum of Islamic Art, Qatar"
});
index.addDoc({
  "lunr_id":1,
  "link":"{{ site.baseurl }}/mia-qatar/10/",
  "title":"Portrait of Hasan 'Ali Mirza Shuja al-Saltana",
  "artist":"Unknown",
  "location":"Iran",
  "_date":"1800 - 1850",
  "object_type":"portrait",
  "current_location":
  "The Museum of Islamic Art, Qatar"
});
```

## Requirements
You will either need a copy of [ElasticLunr](https://cdnjs.com/libraries/elasticlunr) or a reference to a CDN version in your site. `wax:lunr` does not *yet* generate a default `lunr-ui.js ` file, so you will need to create one as well as a Jekyll include for your search box. Samples are [here](https://github.com/mnyrop/wax/blob/master/js/lunr-ui.js) and [here](https://github.com/mnyrop/wax/blob/gem/_includes/search.html), respectively.

`wax:lunr` also looks for a `permalink` field on each `.md` page it indexes. This field is automatically generated by `wax:pagemaster`. If you want to index pages you have added manually, make sure you include a permalink field in the front matter.

## Configuration

Add the `lunr_index` info to your preexisting collections in `_config.yml`. This will include a boolean for indexing the `content` on the page (in addition to the font matter), and an array of `fields`:
```yaml
collections:
  objects:
    source: objects.csv
    layout: iiif-image-page
    lunr_index:
      content: false
      fields: [title, artist, location, _date, object_type, current_location]
```

You will need to add lunr_indexing info to *each* collection you want to index.

## To use
`$ bundle exec rake wax:lunr`
